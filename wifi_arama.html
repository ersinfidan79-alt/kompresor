

<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="robots" content="noindex,nofollow">
<meta name="googlebot" content="noindex,nofollow">
<title>ESP32 BLE WiFi</title>

<style>
body{background:#111;color:#eee;font-family:Arial;text-align:center}
button{padding:10px 18px;margin:5px;font-size:15px}
li{background:#222;margin:5px;padding:8px;border-radius:6px}
</style>
</head>

<body>
<h2>ESP32 BLE Manager</h2>

<button onclick="connectBLE()">BLE Bağlan</button>
<button onclick="send('START')">START</button>
<button onclick="send('STOP')">STOP</button>
<button onclick="send('RESET')">RESET</button>

<p id="stat">Durum: -</p>

<script>
let ch;

const SERVICE = '00001234-0000-1000-8000-00805f9b34fb';
const CHAR    = '0000abcd-0000-1000-8000-00805f9b34fb';

async function connectBLE(){
  try{
    const device = await navigator.bluetooth.requestDevice({
      filters:[{services:[SERVICE]}]
    });

    const server = await device.gatt.connect();
    const service = await server.getPrimaryService(SERVICE);
    ch = await service.getCharacteristic(CHAR);

    document.getElementById("stat").innerText = "Durum: BLE bağlı";
    alert("BLE bağlantısı OK");
  }catch(e){
    alert("BLE bağlantı hatası");
    console.error(e);
  }
}

function send(cmd){
  if(!ch){
    alert("Önce BLE bağlan");
    return;
  }
  ch.writeValueWithoutResponse(
    new TextEncoder().encode(cmd)
  );
}
</script>

</body>
</html>
